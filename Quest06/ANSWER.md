# Quest 06. 인터넷의 이해

## Topics

- 서버와 클라이언트, 그리고 웹 브라우저
- 인터넷을 구성하는 여러 가지 프로토콜
  - IP (v4): 인터넷 프로토콜, 32비트의 주소 공간 크기를 가지며 8비트마다 .으로 구분하여 XXX.XXX.XXX.XXX 의 형태로 사용한다 (IPV4).
    - 주소를 크게 A,B,C 클래스로 나누는데, 맨 앞의 1바이트를 기준으로 A클래스(1~126), B클래스(128~191), C클래스(192~223)의 주소를 갖는다.
    - | 구분    | 구조 (s: 네트워크, h: 호스트)              | 네트워크 시작 번호 | 호스트 범위(갯수) |
      | ------- | ------------------------------------------ | ------------------ | ----------------- |
      | A클래스 | 0sss ssss. hhhh hhhh. hhhh hhhh. hhhh hhhh | 1~126              | 2^24-2            |
      | B클래스 | 10ss ssss .ssss ssss. hhhh hhhh. hhhh hhhh | 128~191            | 2^16-2            |
      | C클래스 | 110s ssss. ssss ssss. ssss ssss. hhhh hhhh | 192~223            | 2^8-2             |
    - 사용자에게 부여 가능한 주소의 경우 A클래스는 앞 1바이트를 제외한 뒤 2,3,4 바이트를, B클래스는 앞 2바이트를 제외한 뒤 3,4 바이트를, C클래스는 4번 바이트를 사용한다
  - IP (v6) : 주소 공간이 128비트의 크기를 가진다. 또한 패킷 크기에 제한이 없다 (v4 64KB)
    - 16비트의 공간을 16진수로 나타낸 8자리의 수로 표현한다 ex) 2001:0db8:85a3:08d3:1319:8a2e:0370:7334
    - 자리의 수가 0000이 되는 경우, 0으로 축약하거나 생략할 수 있다.
  - 서브넷 마스크 : 서브네팅을 하기 위한 수
    - 호스트 IP를 표시하기 위해 사용되는 수로써 연속된 1과 그 이후의 0들로 이루어져있다.
    - 1을 네트워크 영역으로, 0을 호스트 영역으로 사용하겠다는 의미
    - 네트워크 주소 : 특정 네트워크를 통칭하기 위해 사용하는 주소, 특정 네트워크의 맨 첫번째 IP 주소
    - 브로드캐스트 주소 : 특정 네트워크에 속하는 모든 호스트들이 듣게되는 주소, 특정 네트워크의 맨 마지막 주소
  - TCP
    - 패킷을 주고 받기 위한 스위칭 프로토콜, TCP 세그먼트는 헤더 섹션과, 데이터 섹션으로 구성된다.
    - 헤더의 경우 송신,수신 포트번호 / 세그먼트 누적 시퀀스 번호 (최초 0) / ACK 응답 번호 / 헤더 크기, 예비 필드, flags bit, 윈도우 크기 (한 번에 받을 수 있는 데이터의 양) / 체크섬 비트 (에러 체크용), URG 플래그 (긴급 처리 요청) 오프셋 포인터 / options (0~320 bit, 32의 배수) (/기준으로 4바이트씩 분할 표기)
    - 크게 세 가지 흐름으로 구분한다
      1. 연결 생성
         - 연결을 생성하기 위해서, 3방향 hand-shake를 수행한다 (flag-bit를 통해 각 SYN/ACK를 표시)
         - SYN : 클라이언트가 서버에 SYN 메시지를 보낸다 (시퀀스 번호는 클라이언트가 임의로 설정한 값 A)
         - SYN-ACK : 서버가 클라이언트에게 SYN-ACK 메시지로 응답한다. 이 메시지에 포함된 시퀀스 번호는 (B), 응답 번호는 (A+1)
         - ACK : 클라이언트가 서버에게 ACK 메시지를 보낸다. 이 메시지에 포함된 응답 번호는 (B+1)
      2. 자료 전송
      3. 연결 종료
         - 4방향 Hand-Shake를 사용한다
    - checksum의 경우
      1. 헤더의 일부 값들을 추출한 뒤에, 이를 16비트 단위로 나누고
      2. 각각의 합을 더한 뒤, 1의 보수를 취한다.
      3. 이 checksum을 필드에 적어서 보내고,
      4. 수신자는 같은 방식으로 계산한 뒤에 보수를 취하지 않고, 받은 체크섬과 더하여
      5. 모든 비트가 1이 나오는지 확인하면 된다.
  - HTTP
- DNS

## Checklist

- 인터넷은 어떻게 동작하나요? Internet Protocol Suite의 레이어 모델에 입각하여 설명해 보세요.
  - 인터넷 프로토콜 스위트 : 컴퓨터들이 서로 정보를 주고 받는데 쓰이는 프로토콜 모음 (주로 TCP/IP)
    - 계층 구조
      - 응용 계층 : HTTP
      - 전송 계층 : TCP
      - 인터넷 계층 : IP
      - ARP : 주소 결정 프로토콜, IP 주소를 물리적 네트워크 주소로 대응시키기 위해 사용되는 프로토콜, 48비트의 네트워크 카드 주소를 뜻한다.
      - 네트워크 인터페이스 계층 :
  - 근거리에서 서로 떨어진 두 전자기기가 유선/무선으로 서로 통신하는 프로토콜은 어떻게 동작할까요?
  - 근거리에 있는 여러 대의 전자기기가 서로 통신하는 프로토콜은 어떻게 동작할까요?
  - 아주 멀리 떨어져 있는 두 전자기기가 유선/무선으로 서로 통신하는 프로토콜은 어떻게 동작할까요?
  - 두 전자기기가 신뢰성을 가지고 통신할 수 있도록 하기 위한 프로토콜은 어떻게 동작할까요?
  - HTTP는 어떻게 동작할까요?
- 우리가 브라우저의 주소 창에 www.knowre.com 을 쳤을 때, 어떤 과정을 통해 서버의 IP 주소를 알게 될까요?

## Quest

- tracert(Windows가 아닌 경우 traceroute) 명령을 통해 www.google.com 까지 가는 경로를 찾아 보세요.
  - 어떤 IP주소들이 있나요?
  - 그 IP주소들은 어디에 위치해 있나요?
- Wireshark를 통해 www.google.com 으로 요청을 날렸을 떄 어떤 TCP 패킷이 오가는지 확인해 보세요
  - TCP 패킷을 주고받는 과정은 어떻게 되나요?
  - 각각의 패킷에 어떤 정보들이 담겨 있나요?
- telnet 명령을 통해 http://www.google.com/ URL에 HTTP 요청을 날려 보세요.
  - 어떤 헤더들이 있나요?
  - 그 헤더들은 어떤 역할을 하나요?

## Advanced

- HTTP의 최신 버전인 HTTP/3는 어떤 식으로 구성되어 있을까요?
- TCP/IP 외에 전세계적인 네트워크를 구성하기 위한 다른 방식도 제안된 바 있을까요?

## 의문점

- 네트워크 + 호스트 IP 구조로 동작하게 만든 이유는 무엇일까 그냥 주소를 통채로 고유ID값처럼 사용하는것과 다른 점이 있는가?
  - 상대적으로 작은 주소 공간을 효율적으로 이용할 수 있게 하기 위함이라고는 하는데...
- TCP/IP 통신을 하는 경우 한 번의 전송마다 IP헤더 + TCP헤더 + TCP 데이터(세그먼트) 의 구조가 되는걸까?
  - TCP를 사용하는 경우 데이터(세그먼트)를 여러개로 나누어 전송하게 되는데, 이는 결국 IP 헤더에서 정하는 variable length에 따라서 어떻게 분할될지 정해진다.
